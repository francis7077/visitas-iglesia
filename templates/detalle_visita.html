{% extends "base.html" %}
{% block contenido %}

<h2 class="titulo-principal">ğŸ“– Historial de Visitas</h2>

<div class="tarjeta-perfil">

    <div style="display:flex; justify-content:space-between; align-items:center;">
        <h3>Visitas realizadas</h3>
        <span class="badge ok">
            {{ visitas|length }} registradas
        </span>
    </div>

    {% if visitas %}
        <table>
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Visitado por</th>
                    <th>Nota</th>
                    <th style="text-align:center">Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for v in visitas %}
                <tr {% if loop.first %} style="background:#eef4ff;font-weight:600;" {% endif %}>
                    <td>{{ v.fecha_visita.strftime('%d/%m/%Y') }}</td>
                    <td>{{ v.visitado_por }}</td>
                    <td>{{ v.nota or "â€”" }}</td>
                    <td style="text-align:center">
                        <a href="/editar_visita/{{ v.id }}" title="Editar">âœï¸</a>
                        &nbsp;
                        <a href="/eliminar_visita/{{ v.id }}" 
                           onclick="return confirm('Â¿Eliminar esta visita?')" 
                           title="Eliminar">
                           ğŸ—‘ï¸
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <div class="alerta">
            Este visitante aÃºn no ha sido visitado.
        </div>
    {% endif %}

</div>

<br>

<div class="tarjeta-perfil">

    <h3>â• Registrar nueva visita</h3>

    <form method="post">

        <label>Visitado por</label>
        <select name="visitado_por" required>
            <option value="">Seleccione</option>
            <option>Sociedad de JÃ³venes</option>
            <option>Sociedad de Damas</option>
            <option>Sociedad de Caballeros</option>
            <option>Directiva Local</option>
            <option>Familia Pastoral</option>
            <option>Visita Mixta</option>
        </select>

        <label>Fecha de la visita</label>
        <input type="date" name="fecha_visita" required>

        <label>Nota</label>
        <textarea name="nota" placeholder="Observaciones de la visita..."></textarea>

        <button>
            ğŸ’¾ Guardar visita
        </button>

    </form>

</div>

<div style="text-align:center; margin-top:20px;">
    <a href="/visitas" class="btn-volver">
        â¬… Volver a visitas
    </a>
</div>

{% endblock %}
